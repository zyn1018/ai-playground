@startuml
title 第三方送检主流程
== 发起送检单 ==
同舟系统 -> 品控工作台: 填写预约送检单申请信息

品控工作台-> 品控工作台: 生成送检单id，送检单基础信息落库，生成送检单说明单pdf
品控工作台-> 工单系统: 生成送检工单
工单系统-> 品控工作台: 生成的工单id
品控工作台->品控工作台: 更新送检单基础信息
品控工作台 -> 同舟系统: 返回生成的送检单id

同舟系统->品控工作台:填写送检物流信息
品控工作台->品控工作台:物流信息落库
品控工作台->工单系统:更新对应送检工单的物流信息



== 制定送检标准指标 ==
品控工作台 -> ApolloY: 获取商品对应SQE判断指派人规则
ApolloY -> 品控工作台: 返回配置
品控工作台->工单系统: 指定工单接收人
alt 引用神匠模块化指标
    品控工作台->品控神匠: 获取神匠模块化指标列表
品控神匠->品控工作台:返回指标列表
else 上传指标附件
    品控工作台-> FMS: 上传指标附件
end

品控工作台-> 工单系统: 更新对应工单的指标信息

品控工作台->供应商协同系统:获取送检单指定的第三方送检机构信息
供应商协同系统-> 品控工作台: 返回送检机构信息
品控工作台->UAS: 发送邮件、短信通知第三方送检机构
 
== 送检机构确认送检指标 ==
    同舟系统->品控工作台: 审核送检指标
    alt 送检机构确认指标可行
        品控工作台->工单系统:跳转到送检机构填写送检结果节点
    else 送检机构驳回
        品控工作台-> 工单系统:跳回到严选确认送检指标
    end

== 送检机构填写送检结果 ==
同舟系统->品控工作台: 填写送检整体结果
品控工作台->工单系统: 将送检结果更新到对应的送检工单

== 严选确认送检结果 ==
品控工作台->工单系统: 更新确认结果到工单，支持编辑付费方
alt 确认送检结果
    品控工作台->品控工作台: 落库送检单结果信息、送检单状态

else 严选驳回送检结果
    品控工作台->工单系统: 送检工单跳回送检机构填写送检结果节点

end


@enduml